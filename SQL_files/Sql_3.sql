/* Task 1 create car sales data table*/
CREATE DATABASE IF NOT EXISTS CAR_SALES_DATA;
CREATE TABLE CAR_SALES_DATA.SALESPERSONS_DATA
(
SALESPERSON_SALESID INT PRIMARY KEY,
SALESPERSON_NAME VARCHAR(100) NOT NULL,
SALESPERSON_CITY VARCHAR(100),
COMMISSION_RATE INT
);
/* TASK 2 CREATE customer data table*/

CREATE TABLE CAR_SALES_DATA.CUSTOMER_DATAS
(
C_CUSTOMERID INT PRIMARY KEY NOT NULL,
C_FIRSTNAME VARCHAR(100) NOT NULL,
C_LASTNAME VARCHAR (100) NOT NULL,
C_CITY VARCHAR(50) NOT NULL,
C_RATING INT NOT NULL,
SALESID INT NOT NULL,
FOREIGN KEY (SALESID) REFERENCES CAR_SALES_DATA.SALESPERSONS_DATA(SALESPERSON_SALESID)
);

DESC CAR_SALES_DATA.CUSTOMER_DATAS;

CREATE TABLE CAR_SALES_DATA.ORDERS_RECEIVED 
(
ORDER_ID INT NOT NULL,
AMOUNT INT NOT NULL,
ORDERDATE DATE NOT NULL,
CUSTOMERID INT NOT NULL,
FOREIGN KEY (CUSTOMERID) REFERENCES CAR_SALES_DATA.CUSTOMER_DATAS(C_CUSTOMERID)
);

DESC CAR_SALES_DATA.ORDERS_RECEIVED;

/* TASK 4*/

INSERT INTO CAR_SALES_DATA.SALESPERSONS_DATA(SALESPERSON_SALESID, SALESPERSON_NAME, SALESPERSON_CITY, COMMISSION_RATE)
VALUES (1001, 'PEEI', 'LONDON', 12),
	   (1002, 'SERRES', 'SAN JOSE', 13),
       (1003, 'AXELROD', 'NEW YORK', 10),
       (1004, 'JUDITH', 'LONDON', 11),
       (1005, 'FRAN', 'LONDON', 26),
       (1007, 'RIFKIN', 'BARCELONA', 15),
       (1008, 'JOHN', 'LONDON', 0),
       (1009, 'CHARLES', 'FLORIDA', NULL);

/* TASK 5*/

INSERT INTO CAR_SALES_DATA.CUSTOMER_DATAS(C_CUSTOMERID, C_FIRSTNAME, C_LASTNAME, C_CITY, C_RATING, SALESID)
VALUES (2001, 'HOFFMAN', 'ANNY', 'LONDON', 100, 1001),
	   (2002, 'GIOVANNI', 'JENNY', 'ROME', 200, 1003),
       (2003, 'LIU', 'WILLIAMS', 'SAN JOSE', 100, 1002),
       (2004, 'GRASS', 'HARRY', 'BERLIN', 300, 1002),
       (2005, 'CLEMENS', 'JOHN', 'LONDON', 200, 1001),
       (2006, 'CISNEROS', 'FANNY', 'SAN JOSE', 200, 1007),
       (2007, 'PEREIRA', 'JONATHAN', 'ROME', 300, 1004);
       
       
       /* TASK 6*/
       
SET FOREIGN_KEY_CHECKS = 0;
       
INSERT INTO CAR_SALES_DATA.ORDERS_RECEIVED(ORDER_ID, AMOUNT, ORDERDATE, CUSTOMERID)
VALUES (3001, 123, '2020-02-01',2007),
	   (3002, 100, '2020-07-30', 2007),
       (3003, 187, '2020-10-02', 2001),
       (3005, 201, '2011-10-09', 2003),
       (3007, 167, '2020-04-02', 2022),
       (3008, 189, '2020-03-06', 2022),
       (3009, 145, '2012-10-10', 2005),
       (3010, 200, '2012-02-23', 2006),
       (3011, 100, '2000-09-18', 2004);
       
       
/* TASK 7*/

CREATE TABLE CAR_SALES_DATA.TEAM SELECT SALESID, CUSTOMERID from CAR_SALES_DATA.CUSTOMER_DATAS, CAR_SALES_DATA.ORDERS_RECEIVED;
SELECT * FROM CAR_SALES_DATA.TEAM;

/* TASK 8*/

SET SQL_SAFE_UPDATES = 0;
DELETE FROM  CAR_SALES_DATA.ORDERS_RECEIVED WHERE ORDER_ID = 3011;

/* TASK 9*/

DELETE FROM CAR_SALES_DATA.SALESPERSONS_DATA WHERE  COMMISSION_RATE = 0;

/* TASK 10*/

UPDATE CAR_SALES_DATA.ORDERS_RECEIVED SET AMOUNT = 'AMOUNT'*1.2 WHERE AMOUNT<100;

/* TASK 11*/

ALTER TABLE CAR_SALES_DATA.CUSTOMER_DATAS ADD INDEX C_RATING_INDEX (C_RATING);

/* TASK 12*/

UPDATE CAR_SALES_DATA.SALESPERSONS_DATA SET COMMISSION_RATE = 26 WHERE COMMISSION_RATE = 28;

SELECT * FROM CAR_SALES_DATA.SALESPERSONS_DATA;

/* TASK 13*/

UPDATE CAR_SALES_DATA.CUSTOMER_DATAS SET C_RATING = 150 WHERE C_RATING = 100;